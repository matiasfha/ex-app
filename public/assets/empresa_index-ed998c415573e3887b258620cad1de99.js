(function(){require.config({shim:{modernizr:{exports:"Modernizr"},"underscore-min":{exports:"_"},"backbone-min":{deps:["underscore-min"],exports:"Backbone"},"File/FileAPI.min":{exports:"FileAPI"},"jquery.serializeObject":["jquery"],"jquery.numeric":["jquery"],"jquery.rutvalidate":["jquery"],"jquery.isotope":["jquery"]}}),require(["jquery","domReady","jquery.numeric","File/FileAPI.min","jquery.serializeObject","jquery.rutvalidate","jquery.isotope"],function(e,t,n,r,i,s,o){return t(function(){var t,n,r,i,s,o;return e.fn.reset=function(){return e(this).each(function(){return this.reset()})},o=e('meta[name="csrf-token"]').attr("content"),r=e('meta[name="csrf-param"]').attr("content"),e.ajaxSetup({beforeSend:function(e){return e.setRequestHeader("X-CSRF-Token",o)},cache:!1}),e(".numeric").numeric(),e("div.mensajes").delay(2e3).fadeOut(),i=function(t){var n;return n=FileAPI.getFiles(e("#user_avatar")),n=n[0],FileAPI.readAsDataURL(n,function(t){var n,r,i,s,o;switch(t.type){case"load":return o=e("<div></div>").css({position:"absolute",left:"-999999px",width:"400px",height:"600px"}).appendTo(e("body")),s=1,i=1,r=e("<img>"),r.attr("src",t.result).load(function(t){var n;return n=e(this),e(this).appendTo(o),e(this).imagesLoaded(function(){var t,r;return s=n.width(),i=n.height(),o.remove(),r=120,t=150,s>i?s>r&&(i*=r/s,s=r):i>t&&(s*=t/i,i=t),n.attr("width",s),n.attr("height",i),e("div.avatar").html(n)})});case"progress":return e("div.avatar").animate({opacity:t.loaded/t.total*100});default:return n="<span>No se puede mostrar un preview del nuevo Avatar, tu Navegador no lo soporta.<br />Aún así podrá actualizarse sin problemas</span>",e("div.avatar").html(n)}})},s=function(t){var n,r,i;return i="password",e(t.currentTarget).is(":checked")&&(i="text"),n=e("#user_password").clone(),n.attr("type",i),r=e("#user_password_confirmation").clone(),r.attr("type",i),e("#user_password").after(n).remove(),e("#user_password_confirmation").after(r).remove()},t=function(t){var n,r,i,s,o,u;n=!1,i=e('#paso1 :text[value=""],#paso1 :password[value=""]');if(i.length>0){n=!0;for(o=0,u=i.length;o<u;o++)r=i[o],e(r).addClass("error")}s=e("#paso1 select option:selected"),s.val()===""&&(e("#paso1 select").addClass("error"),n=!0),e("#user_password").val().length<6&&(n=!0,e("#user_password,#user_password_confirmation").addClass("error")),e("#user_password").val()!==e("#user_password_confirmation").val()&&(n=!0,e("#user_password,#user_password_confirmation").addClass("error")),e("#user_empresa_rut_empresa").rutValidate(e("#user_empresa_dv_empresa").val())||(e("#user_empresa_rut_empresa,#user_empresa_dv_empresa").addClass("error"),n=!0);if(!n)return e("#paso1").fadeOut("slow",function(t){return e("#paso2").fadeIn("slow"),e("ul.pasos li:nth-child(2) div").removeClass("paso-off").addClass("paso-on")})},n=function(t){var n,r,i,s,o,u;n=!1,i=e('#paso2 :text[value=""]');if(i.length>0){n=!0;for(o=0,u=i.length;o<u;o++)r=i[o],e(r).addClass("error")}s=e("#paso2 #user_empresa_representante_tipo_telefono option:selected"),s.val()===""&&(e("#paso2 #user_empresa_representante_tipo_telefono").addClass("error"),n=!0),s=e("#paso2 #user_country_id option:selected"),s.val()===""&&(e("#paso2 #user_country_id").addClass("error"),n=!0),e("#condiciones").is(":checked")||(n=!0,alert("Debe aceptar las condiciones de uso para continuar"));if(!n)return e("#recaptcha_modal").fadeIn()},e(".error").live("focus",function(t){return e(this).removeClass("error")}),e("#user_avatar").on("change",i),e("#show").on("click",s),e("#go_paso2").on("click",t),e("#go_paso3").on("click",n),e("#recaptcha_response_field").on("keypress",function(t){if(t.which===13)return e("#new_user").submit()}),e("#ir_paso1").click(function(t){if(!e("#paso1").is(":visible")&&e("#paso2").is(":visible"))return e("#paso2").fadeOut("slow",function(t){return e("#paso1").fadeIn("slow"),e("ul.pasos li:nth-child(2) div").removeClass("paso-on").addClass("paso-off")})}),e("#ir_paso2").click(function(t){if(!e("#paso2").is(":visible"))return e("#paso1").fadeOut("slow",function(){return e("#paso2").fadeIn("slow"),e("ul.pasos li:nth-child(2) div").removeClass("paso-off").addClass("paso-on")})})})})}).call(this);